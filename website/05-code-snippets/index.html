<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Snippets </title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">

</head>

<body data-bs-theme="dark">
  <!-- LEFT SIDE -->
  <div class="left">
    <input type="text" id="search" placeholder="Search snippets...">
    <ul id="snippetList"></ul>
  </div>

  <!-- RIGHT SIDE -->
  <div class="right">
    <div class="header">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault"
          onclick="toggleTheme()">
      </div>
    </div>
    <br />
    <div class="code-container">
      <div class="code-header">
        <span>Code Snippet</span>
        <button id="copyBtn" class="copy-btn">ðŸ“‹</button>
      </div>
      <pre id="previewArea" class="code-block">
    Select a snippet to view its content
      </pre>
    </div>
  </div>

  <!-- Hidden Snippet Storage -->
  <div id="snippets">
    <div class="hiddenSnippet" data-name="streak">
      //This script extracts all stock symbols from the first column of the results table on the Streak scanner page,
      // formats them either for Fyers (NSE:SYMBOL-EQ,) or TradingView (NSE:SYMBOL,),
      // and then automatically copies the formatted output to clipboard and prints it in the console for easy use.
      // It works on the below Streak scanner page:
      //https://www.streak.tech/explore/scanner/possible-uptrend?tab=discover

      function getSymbols(src, type) {
      const result = [...document.querySelectorAll('tbody tr td:first-child p:first-child')]
      .map(el => type === "Fyers"
      ? `NSE:${el.textContent.trim()}-EQ,`
      : `NSE:${el.textContent.trim()},`)
      .join('\n');
      copy(result);
      console.log(result);
      }

      getSymbols("anything","Fyers");
      getSymbols("anything","TV");
    </div>

    <div class="hiddenSnippet" data-name="JavaScript TimeStamp">
      const now = new Date();
      const formattedCustom = `${now.getFullYear()}-${(now.getMonth() + 1).toString().padStart(2,
      '0')}-${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2,
      '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
      console.log(formattedCustom)
    </div>

    <div class="hiddenSnippet" data-name="Message Alert">
      function showAlert(){
      alert("Hello World!");
      }
      showAlert();
    </div>

    <div class="hiddenSnippet" data-name="Copy Chartink Watchlist from screener">
      /*
      * https://chartink.com/screener/j-temp-3
      * Paste this file's contents into the Chrome DevTools console on the page
      * containing the table (or include it on the page) to add a floating button
      * that copies the watchlist as comma-separated values like:
      *   NSE:BHARATWIRE-EQ, NSE:HNDFDS-EQ
      * 
      * https://chartink.com/screener/j-temp-3
      */

      (function(){
        if (window.__copyWatchlistButton) return window.__copyWatchlistButton; // avoid duplicates

        function createButton() {
          const btn = document.createElement('button');
          btn.textContent = 'Copy Watchlist';
          Object.assign(btn.style, {
            position: 'fixed',
            right: '16px',
            bottom: '16px',
            zIndex: 999999,
            padding: '10px 14px',
            background: '#0b5cff',
            color: '#fff',
            border: 'none',
            borderRadius: '8px',
            cursor: 'pointer',
            boxShadow: '0 6px 18px rgba(11,92,255,0.2)',
            fontSize: '13px',
            fontWeight: '600'
          });
          btn.title = 'Copy watchlist to clipboard';
          return btn;
        }

        async function copyText(text) {
          try {
            if (navigator.clipboard && navigator.clipboard.writeText) {
              await navigator.clipboard.writeText(text);
              return true;
            }
          } catch(e){ /* fallthrough to fallback */ }

          // fallback for pages without clipboard permission
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.style.position = 'fixed';
          ta.style.left = '-9999px';
          document.body.appendChild(ta);
          ta.select();
          try {
            document.execCommand('copy');
            document.body.removeChild(ta);
            return true;
          } catch (err) {
            document.body.removeChild(ta);
            return false;
          }
        }

        function extractSymbols() {
          // Find the table in the page and the symbol cells.
          // This targets the "Symbol" column (third <td> in each row) from the provided HTML.
          const rows = Array.from(document.querySelectorAll('table tbody tr'));
          const symbols = rows.map(row => {
            const tds = row.querySelectorAll('td');
            const td = tds[2];
            if (!td) return null;
            const a = td.querySelector('a');
            const txt = (a ? a.innerText : td.innerText).trim();
            return txt.replace(/\s+/g, '');
          }).filter(Boolean);
          return symbols;
        }

        function formatList(symbols, trailingComma=false) {
          const list = symbols.map(s => `NSE:${s}-EQ`).join(', ');
          return trailingComma ? (list + ', ') : list;
        }

        const btn = createButton();
        btn.addEventListener('click', async () => {
          const symbols = extractSymbols();
          if (!symbols.length) {
            alert('No symbols found in table.');
            return;
          }
          const text = formatList(symbols);
          const ok = await copyText(text);
          if (ok) {
            btn.textContent = 'Copied!';
            setTimeout(()=> btn.textContent = 'Copy Watchlist', 1500);
          } else {
            alert('Copy failed. Selected text:\n\n' + text);
          }
        });

        document.body.appendChild(btn);
        window.__copyWatchlistButton = {
          button: btn,
          remove() { btn.remove(); delete window.__copyWatchlistButton; }
        };
        return window.__copyWatchlistButton;
      })();

    </div>

  </div>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script src="../../global.js"></script>
  <script src="script.js"></script>
</body>

</html>